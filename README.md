# Проект. Stellar Burgers


## Описание
"Stellar Burgers" — это веб-приложение космической бургерной, где пользователи могут собирать и заказывать бургеры, просматривать ленту заказов и управлять профилем. В проекте реализованы маршрутизация, авторизация и защищённые страницы, а также взаимодействие с API для отображения данных в реальном времени.


## Используемые технологии

- HTML
- CSS
- JS
- TS
- React
- Redux (Redux Toolkit)
- React Router
- JWT
- Jest
- Cypress


## Установка и запуск проекта
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn install
yarn start
```

### Запуск тестов

#### Jest

```
npm run test
```

или

```
yarn test
```

#### Cypress

```
npm run cypress:open
```

или

```
yarn cypress:open
```


## Сборка

```
npm run build
```

или

```
yarn build
```


## Учтенность функциональных требований:
### Конструктор бургеров:
Динамический подсчёт стоимости, добавление/удаление ингредиентов
Оформление заказа только для авторизованных пользователей
Модальные окна с деталями ингредиентов и заказов

### Авторизация и профиль:
- Защищённые маршруты (/profile, /profile/orders)
- Редактирование данных пользователя с кнопками «Сохранить»/«Отмена»
- Выход с очисткой токенов

### Лента заказов:
- Отображение заказов в реальном времени (WebSocket)
- Модальные окна при клике на заказ (/feed/:number)
- История заказов пользователя (/profile/orders)

### Технические требования:
- Типизация (TypeScript) для компонентов, Redux и API
- Чистые редюсеры (Redux Toolkit)
- Оптимизация (React.memo, useCallback)


## Реализация

- Выполнена настройка роутинга
- Использованы запросы к серверу вместе с Redux-функционалом
- Настроен запрос авторизации

## Обновления

### Интеграционные тесты (Cypress)

Тестирование конструктора бургеров

#### Моки данных:

- ingredients.json - моковые данные ингредиентов
- order.json - моковые данные заказа
- account.json - моковые данные пользователя
- login.json - моковые данные авторизации

#### Основные тест-кейсы:

##### 1. Добавление ингредиентов:
- Добавление булки (проверка что добавляется 2 элемента - верх и низ)
- Добавление начинки и соуса (проверка количества элементов)

##### 2. Тестирование модальных окон:
- Открытие модального окна с деталями ингредиента
- Закрытие модального окна:
- Через кнопку закрытия
- Через клик по оверлею

##### 3. Создание заказа:
- Сборка полного бургера (булка + начинка + соус)
Оформление заказа с проверкой:
- Открытия модального окна с номером заказа
- Корректности отправляемых данных
- Очистки конструктора после заказа

#### Особенности реализации:
- Перехваты API-запросов (api/ingredients, api/orders, api/auth/user)
- Автоматическая авторизация перед тестами
- Очистка данных после тестов

### Юнит-тесты (Jest)

Тестирование Redux-стора

####  Тестируемые модули:

##### 1. rootReducer:
- Корректность структуры RootState.
- Корректная инициализация всех подключённых редьюсеров (например, items, ingredients, feeds, user).

##### 2. burgerConstructorReducer:
Покрытие включает:
- Инициализационное состояние.
- Обработка добавления булочки и ингредиентов (addIngredient).
- Удаление ингредиента по id (removeIngredient).
- Перемещение ингредиентов вверх и вниз (moveIngredient), включая граничные случаи.
- Сброс конструктора бургера (reset).

##### 3. feedsReducer:
Проверяются:
- Начальное состояние и загрузка данных.
- Обработка асинхронных экшенов fetchFeeds и fetchOrderByNumber на всех стадиях (pending, rejected, fulfilled).
- Сохранение текущего заказа и ленты при взаимных вызовах экшенов.

##### 4. ingredientsReducer:
Покрытие:
- Проверка начального состояния.
- Обработка загрузки ингредиентов через fetchIngredients
- Проверка поведения extraReducers при различных сценариях.

##### 5. userReducer:
Проверяется:
- Начальное состояние.
- Синхронные экшены:
    - Изменение аутентифицированного статуса (changeAuthStatus).
    - Установка последнего заказа (changeLastOrder).
- Асинхронные экшены:
    - Аутентификация (fetchUser, login, register, updateUser).
    - Выход из системы (logout) с сохранением истории заказов.
    - Загрузка заказов пользователя (fetchUserOrders).
    - Создание нового заказа (createOrder) с изменением состояния и добавлением заказа в историю.
